@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix uco-obs: <https://ontology.unifiedcyberontology.org/uco/observable/> .
@prefix pact: <http://your-org.com/ns/pact#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# Rule: "Sensitive Config Files Must NOT be owned by Root"
pact:NoRootConfigShape
    a sh:NodeShape ;
    sh:targetClass uco-obs:File ;  # Look at every 'File' object
    sh:property [
        sh:path uco-obs:owner ;    # Check the 'owner' property
        sh:not [ sh:hasValue "root" ] ;   # It MUST NOT be "root"
        sh:message "VIOLATION: File is owned by root user." ;
        sh:severity sh:Violation ;
    ] .

# ----------------------------------------------------------------
# RULE 2: NETWORK SECURITY (NIST CM-7)
# Requirement: No insecure ports (specifically Port 23 Telnet)
# ----------------------------------------------------------------

pact:NoTelnetShape
    a sh:NodeShape ;
    sh:targetClass uco-obs:NetworkConnection ;
    sh:message "Non-Compliant: Insecure Telnet Port (23) Detected." ;
    
    sh:property [
        sh:path uco-obs:destinationPort ;
        sh:not [
            sh:hasValue 23 ;
        ] ;
    ] .